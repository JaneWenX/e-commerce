{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/xialiangwen/Desktop/web_projects/e-commerce/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19,_templateObject20,_templateObject21,_templateObject22,_templateObject23,_templateObject24,_templateObject25,_templateObject26,_templateObject27,_templateObject28,_templateObject29,_templateObject30,_templateObject31;import styled from\"styled-components\";// importing from styled-components\nimport{useContext,useEffect}from\"react\";// importing from react\nimport axios from\"axios\";// importing from axios\nimport{useHistory}from\"react-router-dom\";// importing from react-router-dom\nimport{ItemContext}from\"../context/Context\";// importing from ItemContext\nimport{v4 as uuidv4}from\"uuid\";// importing from uuid\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Checkout=function Checkout(){var _useContext=useContext(ItemContext),cart=_useContext.cart,setCart=_useContext.setCart,Items=_useContext.Items,setError=_useContext.setError;var myCart=cart.data;var subtotal=0;var total=0;var history=useHistory();var quantityArray=[];//fetches cart from Mongo, and makes it accessible via \"cart\"\nuseEffect(function(){axios.get(\"/api/cart\").then(function(res){setCart(res.data);}).catch(function(err){setError(err);});},[]);//deletes an item from the cart based on its' _id.\nvar deleteItem=function deleteItem(ev){var _id=ev.target.id;axios.delete(\"/api/cart/\".concat(_id)).then(function(res){setError(res.data);document.location.reload(true);}).catch(function(err){setError(err);});};//onSubmit, this function first posts everything into orderHistory, and then deletes them\n//all from cart. Then pushes to orderHistory page.\nvar handleSubmit=function handleSubmit(ev){ev.preventDefault();//posts the order with an id to the orderHistory\naxios({method:\"POST\",url:\"/api/orderHistory\",data:{data:myCart,orderId:uuidv4()}}).then(function(res){history.push(\"/confirmation\");}).catch(function(err){setError(err);});//removes each item from the cart, so that when the purchase is made, you can have a fresh cart.\nmyCart.map(function(item){var _id=item._id;//empties the cart after the order is made\naxios.delete(\"/api/cart/\".concat(_id)).then(function(res){history.push(\"/previous-purchases\");}).catch(function(err){setError(err);});});};if(!cart||!myCart){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading\"});}else{var priceArray=[];//pushes each item id in the cart with its' corresponding quantity to the quantityArray,\n//which will be updated in the cart and used in post to update item stock\nmyCart.map(function(item){quantityArray.push({_id:item._id,quantity:1});});return/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsxs(LeftDiv,{children:[/*#__PURE__*/_jsxs(HeaderDiv,{children:[/*#__PURE__*/_jsx(ShoppingCart,{children:\"Shopping Cart\"}),/*#__PURE__*/_jsxs(CartQuantity,{children:[myCart.length,\" Item(s)\"]})]}),/*#__PURE__*/_jsxs(CategoryDiv,{children:[/*#__PURE__*/_jsx(Description,{children:\"Description\"}),/*#__PURE__*/_jsx(Quantity,{children:\"Quantity\"}),/*#__PURE__*/_jsx(Price,{children:\"Price\"})]}),myCart.map(function(item){//maps over all Items, finding the _id of the specific cart item, changes stock to\n//the quantity that are actually in stock of that item.\nvar stock=0;Items.map(function(item2){if(item2._id===item._id){stock=item2.numInStock;}});//removes $ from each of the prices, turns them into a Number, and pushes to an array.\nvar itemPriceNoSymbol=item.price.replace(/\\$/g,\"\");var itemPrice=parseInt(itemPriceNoSymbol);priceArray.push(itemPrice);//checks that we're getting the correct total, then adds all of prices together, creating a subtotal\nif(priceArray.length===myCart.length){var reducer=function reducer(accumulator,curr){return accumulator+curr;};subtotal=priceArray.reduce(reducer).toFixed(2);//adds tax\ntotal=(subtotal*1.15).toFixed(2);}//onChange of quantity of item in the cart, updates the quantity in the quantityArray,\n//this will be used in the patch to determine how much of each item will be removed from stock.\nvar quantityHandler=function quantityHandler(e){quantityArray.map(function(object){if(object._id===item._id){object.quantity=parseInt(e.target.value);}});};return/*#__PURE__*/_jsxs(ItemDiv,{ey:item._id,children:[/*#__PURE__*/_jsxs(DescriptionDiv,{children:[/*#__PURE__*/_jsx(Img,{src:item.imageSrc,alt:item.name}),/*#__PURE__*/_jsxs(SubDescripion,{children:[/*#__PURE__*/_jsx(ItemName,{children:item.name}),/*#__PURE__*/_jsx(Remove,{onClick:deleteItem,id:item._id,children:\"Remove\"})]})]}),/*#__PURE__*/_jsx(QuantityDiv,{children:/*#__PURE__*/_jsxs(Form,{onChange:quantityHandler,children:[/*#__PURE__*/_jsx(Input,{type:\"number\",id:\"quantity\",name:\"quantity\",min:\"1\",max:stock}),/*#__PURE__*/_jsxs(Label,{for:\"quantity\",children:[\"Max \",stock===0?1:stock]})]})}),/*#__PURE__*/_jsx(PriceDiv,{children:/*#__PURE__*/_jsx(ItemPrice,{children:item.price})})]});})]}),/*#__PURE__*/_jsxs(RightDiv,{children:[/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Div,{children:\"Order Summary\"}),/*#__PURE__*/_jsxs(Subtotal,{children:[/*#__PURE__*/_jsx(Bold,{children:\"Subtotal\"}),\" $\",subtotal]}),/*#__PURE__*/_jsxs(Total,{children:[/*#__PURE__*/_jsx(Bold,{children:\"Total\"}),\" $\",total]}),/*#__PURE__*/_jsx(Div,{children:\"Personal Information\"}),/*#__PURE__*/_jsx(TextArea,{placeholder:\"Name\",required:true,autoFocus:true}),/*#__PURE__*/_jsx(TextArea,{placeholder:\"Surname\",required:true}),/*#__PURE__*/_jsx(TextArea,{placeholder:\"Email\",required:true}),/*#__PURE__*/_jsx(CheckoutButton,{children:\"Checkout\"})]}),/*#__PURE__*/_jsxs(BelowFormDiv,{children:[/*#__PURE__*/_jsx(ImageHere,{src:\"https://media.giphy.com/media/wtdVYmaRWJ1PyPcc8e/giphy.gif\",alt:\"cart\"}),/*#__PURE__*/_jsx(Instructions,{children:\"We love you!\"})]})]})]});}};// styled components\nvar Wrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  width: 90vw;\\n  color: black;\\n  position: relative;\\n  top: 8vh;\\n  left: 10vw;\\n  display: flex;\\n\"])));var LeftDiv=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  width: 59.2vw;\\n\"])));var HeaderDiv=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  border-bottom: 6px black solid;\\n  margin-top: 10px;\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: flex-end;\\n\"])));var ShoppingCart=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  font-family: var(--primary-font-family);\\n  font-size: 50px;\\n\"])));var CategoryDiv=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  border-bottom: 3px black solid;\\n  color: grey;\\n  font-size: 15px;\\n  display: flex;\\n\"])));var Description=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  width: 60%;\\n  font-family: var(--primary-font-family);\\n  margin-top: 3px;\\n  padding-left: 5px;\\n  align-items: center;\\n  font-size: 2rem;\\n\"])));var Quantity=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  width: 20%;\\n  font-family: var(--primary-font-family);\\n  margin-top: 3px;\\n  font-size: 2rem;\\n\"])));var Price=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  width: 20%;\\n  font-family: var(--primary-font-family);\\n  margin-top: 3px;\\n  font-size: 2rem;\\n\"])));var RightDiv=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  position: fixed;\\n  right: 0;\\n  top: 0;\\n  height: 100vh;\\n  background-color: black;\\n  color: white;\\n  width: 30vw;\\n  display: flex;\\n  flex-direction: column;\\n  justify-items: space-around;\\n\"])));var ItemDiv=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  padding: 15px;\\n  border-bottom: 1px black solid;\\n  display: flex;\\n  align-items: center;\\n\"])));var DescriptionDiv=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  height: 100%;\\n  width: 60%;\\n  display: flex;\\n  padding-right: 10px;\\n  align-items: center;\\n\"])));var Img=styled.img(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  width: 200px;\\n  height: auto;\\n  padding-right: 10px;\\n\"])));var SubDescripion=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: space-around;\\n\"])));var ItemName=styled.div(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  font-family: var(--primary-font-family);\\n  font-size: 20px;\\n\"])));var Remove=styled.button(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\\n  background: none;\\n  border: none;\\n  border-radius: 25px;\\n  box-shadow: 2px 2px 4px 2px rgba(0, 0, 0, 0.5);\\n  align-items: center;\\n  color: grey;\\n  font-family: var(--primary-font-family);\\n  font-size: 17px;\\n  margin-top : 25px;\\n  width: 80px;\\n  padding: 0;\\n  padding: 5px;\\n  cursor: pointer;\\n  transition: 0.5s ease;\\n\\n  &:hover {\\n    transform: scale(1.05);\\n  }\\n\\n  &:active {\\n    box-shadow: 0 5px #666;\\n    transform: translateY(4px);\\n  }\\n\"])));var QuantityDiv=styled.div(_templateObject16||(_templateObject16=_taggedTemplateLiteral([\"\\n  display: flex;\\n  margin-bottom: 70px;\\n  width: 20%;\\n  align-items: center;\\n  padding-left: 15px;\\n\"])));var PriceDiv=styled.div(_templateObject17||(_templateObject17=_taggedTemplateLiteral([\"\\n  width: 20%;\\n  display: flex;\\n  align-items: center;\\n  padding-left: 10px;\\n\"])));var ItemPrice=styled.div(_templateObject18||(_templateObject18=_taggedTemplateLiteral([\"\\n  font-family: var(--secondary-font-family);\\n  font-weight: bold;\\n  font-size: 2.5rem;\\n\"])));var Form=styled.form(_templateObject19||(_templateObject19=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: space-between;\\n  margin-top: 10vh;\\n\"])));var Input=styled.input(_templateObject20||(_templateObject20=_taggedTemplateLiteral([\"\\n  margin-bottom: 3px;\\n  width: 45px;\\n  height: 30px;\\n\"])));var Label=styled.label(_templateObject21||(_templateObject21=_taggedTemplateLiteral([\"\\n  font-family: var(--primary-font-family);\\n  color: grey;\\n\"])));var Div=styled.div(_templateObject22||(_templateObject22=_taggedTemplateLiteral([\"\\n  font-family: var(--primary-font-family);\\n  font-size: 2.5rem;\\n  border-bottom: 1px white solid;\\n\"])));var Bold=styled.span(_templateObject23||(_templateObject23=_taggedTemplateLiteral([\"\\n  font-weight: bold;\\n  margin-right: 15px;\\n\"])));var CartQuantity=styled.div(_templateObject24||(_templateObject24=_taggedTemplateLiteral([\"\\n  font-family: var(--primary-font-family);\\n  font-size: 40px;\\n\"])));var Subtotal=styled.div(_templateObject25||(_templateObject25=_taggedTemplateLiteral([\"\\n  font-family: var(--secondary-font-family);\\n  font-size: 2rem;\\n\"])));var Total=styled.div(_templateObject26||(_templateObject26=_taggedTemplateLiteral([\"\\n  font-family: var(--secondary-font-family);\\n  font-size: 2rem;\\n  margin-bottom: 15px;\\n\"])));var TextArea=styled.textarea(_templateObject27||(_templateObject27=_taggedTemplateLiteral([\"\\n  width: 90%;\\n  resize: none;\\n  font-family: var(--secondary-font-family);\\n  font-size:35px;\\n  margin-bottom: 10px;\\n  margin-top: 10px;\\n  height: 50px;\\n  padding-left: 10px;\\n\\n  &::placeholder {\\n    color: grey;\\n    font-size: 35px;\\n    top: 0;\\n    display: flex;\\n    align-items: center;\\n  }\\n\"])));var CheckoutButton=styled.button(_templateObject28||(_templateObject28=_taggedTemplateLiteral([\"\\n  width: 90%;\\n  border-radius: 15px;\\n  font-family: var(--secondary-font-family);\\n  font-size: 25px;\\n  border: none;\\n  margin-top: 10px;\\n  background-color: white;\\n  color: black;\\n  cursor: pointer;\\n  transition: 0.5s ease;\\n\\n  &:hover {\\n    transform: scale(1.05);\\n  }\\n\\n  &:active {\\n    box-shadow: 0 5px #666;\\n    transform: translateY(4px);\\n  }\\n\"])));var ImageHere=styled.img(_templateObject29||(_templateObject29=_taggedTemplateLiteral([\"\\n  width: 300px;\\n  height: auto;\\n\"])));var BelowFormDiv=styled.div(_templateObject30||(_templateObject30=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  margin-top: 5vh;\\n\"])));var Instructions=styled.div(_templateObject31||(_templateObject31=_taggedTemplateLiteral([\"\\n  font-family: var(--primary-font-family);\\n  font-size: 2rem;\\n\"])));export default Checkout;","map":{"version":3,"sources":["/Users/xialiangwen/Desktop/web_projects/e-commerce/client/src/components/Checkout.js"],"names":["styled","useContext","useEffect","axios","useHistory","ItemContext","v4","uuidv4","Checkout","cart","setCart","Items","setError","myCart","data","subtotal","total","history","quantityArray","get","then","res","catch","err","deleteItem","ev","_id","target","id","delete","document","location","reload","handleSubmit","preventDefault","method","url","orderId","push","map","item","priceArray","quantity","length","stock","item2","numInStock","itemPriceNoSymbol","price","replace","itemPrice","parseInt","reducer","accumulator","curr","reduce","toFixed","quantityHandler","e","object","value","imageSrc","name","Wrapper","div","LeftDiv","HeaderDiv","ShoppingCart","CategoryDiv","Description","Quantity","Price","RightDiv","ItemDiv","DescriptionDiv","Img","img","SubDescripion","ItemName","Remove","button","QuantityDiv","PriceDiv","ItemPrice","Form","form","Input","input","Label","label","Div","Bold","span","CartQuantity","Subtotal","Total","TextArea","textarea","CheckoutButton","ImageHere","BelowFormDiv","Instructions"],"mappings":"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","sourcesContent":["import styled from \"styled-components\"; // importing from styled-components\nimport { useContext, useEffect } from \"react\"; // importing from react\nimport axios from \"axios\"; // importing from axios\nimport { useHistory } from \"react-router-dom\"; // importing from react-router-dom\n\nimport { ItemContext } from \"../context/Context\"; // importing from ItemContext\n\nimport { v4 as uuidv4 } from \"uuid\"; // importing from uuid\n\nconst Checkout = () => {\n  const { cart, setCart, Items, setError } = useContext(ItemContext);\n  const myCart = cart.data;\n  let subtotal = 0;\n  let total = 0;\n  const history = useHistory();\n  let quantityArray = [];\n\n  //fetches cart from Mongo, and makes it accessible via \"cart\"\n  useEffect(() => {\n    axios\n      .get(\"/api/cart\")\n      .then((res) => {\n        setCart(res.data);\n      })\n      .catch((err) => {\n        setError(err);\n      });\n  }, []);\n\n  //deletes an item from the cart based on its' _id.\n  const deleteItem = (ev) => {\n    const _id = ev.target.id;\n    axios\n      .delete(`/api/cart/${_id}`)\n      .then((res) => {\n        setError(res.data);\n        document.location.reload(true);\n      })\n      .catch((err) => {\n        setError(err);\n      });\n  };\n\n  //onSubmit, this function first posts everything into orderHistory, and then deletes them\n  //all from cart. Then pushes to orderHistory page.\n  const handleSubmit = (ev) => {\n    ev.preventDefault();\n    //posts the order with an id to the orderHistory\n    axios({\n      method: \"POST\",\n      url: \"/api/orderHistory\",\n      data: {\n        data: myCart,\n        orderId: uuidv4(),\n      },\n    })\n      .then((res) => {\n        history.push(\"/confirmation\");\n      })\n      .catch((err) => {\n        setError(err);\n      });\n\n\n\n    //removes each item from the cart, so that when the purchase is made, you can have a fresh cart.\n    myCart.map((item) => {\n      const _id = item._id;\n      //empties the cart after the order is made\n      axios\n        .delete(`/api/cart/${_id}`)\n        .then((res) => {\n          history.push(\"/previous-purchases\");\n        })\n        .catch((err) => {\n          setError(err);\n        });\n    });\n  };\n\n  if (!cart || !myCart) {\n    return <div>Loading</div>;\n  } else {\n    const priceArray = [];\n\n    //pushes each item id in the cart with its' corresponding quantity to the quantityArray,\n    //which will be updated in the cart and used in post to update item stock\n    myCart.map((item) => {\n      quantityArray.push({ _id: item._id, quantity: 1 });\n    });\n\n    return (\n      <Wrapper>\n        <LeftDiv>\n          <HeaderDiv>\n            <ShoppingCart>Shopping Cart</ShoppingCart>\n            <CartQuantity>{myCart.length} Item(s)</CartQuantity>\n          </HeaderDiv>\n          <CategoryDiv>\n            <Description>Description</Description>\n            <Quantity>Quantity</Quantity>\n            <Price>Price</Price>\n          </CategoryDiv>\n          {myCart.map((item) => {\n            //maps over all Items, finding the _id of the specific cart item, changes stock to\n            //the quantity that are actually in stock of that item.\n            let stock = 0;\n            Items.map((item2) => {\n              if (item2._id === item._id) {\n                stock = item2.numInStock;\n              }\n            });\n\n            //removes $ from each of the prices, turns them into a Number, and pushes to an array.\n            const itemPriceNoSymbol = item.price.replace(/\\$/g, \"\");\n            const itemPrice = parseInt(itemPriceNoSymbol);\n            priceArray.push(itemPrice);\n            //checks that we're getting the correct total, then adds all of prices together, creating a subtotal\n            if (priceArray.length === myCart.length) {\n              const reducer = (accumulator, curr) => accumulator + curr;\n              subtotal = priceArray.reduce(reducer).toFixed(2);\n              //adds tax\n              total = (subtotal * 1.15).toFixed(2);\n            }\n\n            //onChange of quantity of item in the cart, updates the quantity in the quantityArray,\n            //this will be used in the patch to determine how much of each item will be removed from stock.\n            const quantityHandler = (e) => {\n              quantityArray.map((object) => {\n                if (object._id === item._id) {\n                  object.quantity = parseInt(e.target.value);\n                }\n              });\n            };\n\n            return (\n              <ItemDiv ey={item._id}>\n                <DescriptionDiv>\n                  <Img src={item.imageSrc} alt={item.name} />\n                  <SubDescripion>\n                    <ItemName>{item.name}</ItemName>\n                    <Remove onClick={deleteItem} id={item._id}>\n                      Remove\n                    </Remove>\n                  </SubDescripion>\n                </DescriptionDiv>\n                <QuantityDiv>\n                  <Form onChange={quantityHandler}>\n                    <Input\n                      type=\"number\"\n                      id=\"quantity\"\n                      name=\"quantity\"\n                      min=\"1\"\n                      max={stock}\n                    />\n                    <Label for=\"quantity\">Max {stock === 0 ? 1 : stock}</Label>\n                  </Form>\n                </QuantityDiv>\n                <PriceDiv>\n                  <ItemPrice>{item.price}</ItemPrice>\n                </PriceDiv>\n              </ItemDiv>\n            );\n          })}\n        </LeftDiv>\n        <RightDiv>\n          <Form onSubmit={handleSubmit}>\n            <Div>Order Summary</Div>\n            <Subtotal>\n              <Bold>Subtotal</Bold> ${subtotal}\n            </Subtotal>\n            <Total>\n              <Bold>Total</Bold> ${total}\n            </Total>\n            <Div>Personal Information</Div>\n            <TextArea placeholder=\"Name\" required autoFocus></TextArea>\n            <TextArea placeholder=\"Surname\" required></TextArea>\n            <TextArea placeholder=\"Email\" required></TextArea>\n            <CheckoutButton>Checkout</CheckoutButton>\n          </Form>\n          <BelowFormDiv>\n             <ImageHere src=\"https://media.giphy.com/media/wtdVYmaRWJ1PyPcc8e/giphy.gif\" alt=\"cart\" />\n             <Instructions>\n              We love you! \n             </Instructions>\n          </BelowFormDiv>\n        </RightDiv>\n      </Wrapper>\n    );\n  }\n};\n\n// styled components\n\nconst Wrapper = styled.div`\n  width: 90vw;\n  color: black;\n  position: relative;\n  top: 8vh;\n  left: 10vw;\n  display: flex;\n`;\n\nconst LeftDiv = styled.div`\n  width: 59.2vw;\n`;\n\nconst HeaderDiv = styled.div`\n  width: 100%;\n  border-bottom: 6px black solid;\n  margin-top: 10px;\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-end;\n`;\n\nconst ShoppingCart = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 50px;\n`;\n\nconst CategoryDiv = styled.div`\n  width: 100%;\n  border-bottom: 3px black solid;\n  color: grey;\n  font-size: 15px;\n  display: flex;\n`;\n\nconst Description = styled.div`\n  width: 60%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n  padding-left: 5px;\n  align-items: center;\n  font-size: 2rem;\n`;\n\nconst Quantity = styled.div`\n  width: 20%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n  font-size: 2rem;\n`;\n\nconst Price = styled.div`\n  width: 20%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n  font-size: 2rem;\n`;\n\n\nconst RightDiv = styled.div`\n  position: fixed;\n  right: 0;\n  top: 0;\n  height: 100vh;\n  background-color: black;\n  color: white;\n  width: 30vw;\n  display: flex;\n  flex-direction: column;\n  justify-items: space-around;\n`;\n\nconst ItemDiv = styled.div`\n  padding: 15px;\n  border-bottom: 1px black solid;\n  display: flex;\n  align-items: center;\n`;\n\nconst DescriptionDiv = styled.div`\n  height: 100%;\n  width: 60%;\n  display: flex;\n  padding-right: 10px;\n  align-items: center;\n`;\n\nconst Img = styled.img`\n  width: 200px;\n  height: auto;\n  padding-right: 10px;\n`;\n\nconst SubDescripion = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n`;\n\nconst ItemName = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 20px;\n`;\n\nconst Remove = styled.button`\n  background: none;\n  border: none;\n  border-radius: 25px;\n  box-shadow: 2px 2px 4px 2px rgba(0, 0, 0, 0.5);\n  align-items: center;\n  color: grey;\n  font-family: var(--primary-font-family);\n  font-size: 17px;\n  margin-top : 25px;\n  width: 80px;\n  padding: 0;\n  padding: 5px;\n  cursor: pointer;\n  transition: 0.5s ease;\n\n  &:hover {\n    transform: scale(1.05);\n  }\n\n  &:active {\n    box-shadow: 0 5px #666;\n    transform: translateY(4px);\n  }\n`;\n\nconst QuantityDiv = styled.div`\n  display: flex;\n  margin-bottom: 70px;\n  width: 20%;\n  align-items: center;\n  padding-left: 15px;\n`;\n\nconst PriceDiv = styled.div`\n  width: 20%;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n`;\nconst ItemPrice = styled.div`\n  font-family: var(--secondary-font-family);\n  font-weight: bold;\n  font-size: 2.5rem;\n`;\n\nconst Form = styled.form`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-between;\n  margin-top: 10vh;\n`;\n\nconst Input = styled.input`\n  margin-bottom: 3px;\n  width: 45px;\n  height: 30px;\n`;\n\nconst Label = styled.label`\n  font-family: var(--primary-font-family);\n  color: grey;\n`;\n\nconst Div = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 2.5rem;\n  border-bottom: 1px white solid;\n`;\n\nconst Bold = styled.span`\n  font-weight: bold;\n  margin-right: 15px;\n`;\n\nconst CartQuantity = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 40px;\n`;\n\nconst Subtotal = styled.div`\n  font-family: var(--secondary-font-family);\n  font-size: 2rem;\n`;\nconst Total = styled.div`\n  font-family: var(--secondary-font-family);\n  font-size: 2rem;\n  margin-bottom: 15px;\n`;\n\nconst TextArea = styled.textarea`\n  width: 90%;\n  resize: none;\n  font-family: var(--secondary-font-family);\n  font-size:35px;\n  margin-bottom: 10px;\n  margin-top: 10px;\n  height: 50px;\n  padding-left: 10px;\n\n  &::placeholder {\n    color: grey;\n    font-size: 35px;\n    top: 0;\n    display: flex;\n    align-items: center;\n  }\n`;\n\nconst CheckoutButton = styled.button`\n  width: 90%;\n  border-radius: 15px;\n  font-family: var(--secondary-font-family);\n  font-size: 25px;\n  border: none;\n  margin-top: 10px;\n  background-color: white;\n  color: black;\n  cursor: pointer;\n  transition: 0.5s ease;\n\n  &:hover {\n    transform: scale(1.05);\n  }\n\n  &:active {\n    box-shadow: 0 5px #666;\n    transform: translateY(4px);\n  }\n`;\n\nconst ImageHere = styled.img`\n  width: 300px;\n  height: auto;\n`\n\nconst BelowFormDiv = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 5vh;\n`\n\nconst Instructions = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 2rem;\n`\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}