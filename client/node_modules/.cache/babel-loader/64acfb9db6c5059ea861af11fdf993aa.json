{"ast":null,"code":"var _jsxFileName = \"/Users/xialiangwen/Desktop/Bootcamp/concordia-bootcamps/project-GROUP-e-commerce/client/src/components/Checkout.js\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { useContext } from \"react\";\nimport { useEffect } from \"react\";\nimport { ItemContext } from \"../context/Context\";\nimport styled from \"styled-components\";\nimport { useHistory } from \"react-router-dom\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Checkout = () => {\n  _s();\n\n  const {\n    cart,\n    setCart,\n    Items\n  } = useContext(ItemContext);\n  const myCart = cart.data;\n  let subtotal = 0;\n  let total = 0;\n  const history = useHistory();\n  let quantityArray = []; //fetches cart from Mongo, and makes it accessible via \"cart\"\n\n  useEffect(() => {\n    axios.get(\"/api/cart\").then(res => {\n      setCart(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []); //deletes an item from the cart based on its' _id.\n\n  const deleteItem = ev => {\n    const _id = ev.target.id;\n    axios.delete(`/api/cart/${_id}`).then(res => {\n      console.log(res.data);\n      document.location.reload(true);\n    }).catch(err => {\n      console.log(err);\n    });\n  }; //onSubmit, this function first posts everything into orderHistory, and then deletes them\n  //all from cart. Then pushes to orderHistory page.\n\n\n  const handleSubmit = ev => {\n    //posts the order with an id to the orderHistory \n    axios({\n      method: \"POST\",\n      url: \"/api/orderHistory\",\n      data: {\n        data: myCart,\n        orderId: uuidv4()\n      }\n    }); //sends the quantityArray to the server. Server will iterate over each object in the a array,\n    //and modify the numInStock of each item depending on the quantity purchased.\n\n    axios({\n      method: 'patch',\n      url: '/api/shop/items',\n      data: {\n        body: quantityArray\n      }\n    }); //removes each item from the cart, so that when the purchase is made, you can have a fresh cart.\n\n    myCart.map(item => {\n      const _id = item._id; //empties the cart after the order is made\n\n      axios.delete(`/api/cart/${_id}`).then(res => {\n        console.log(res.data);\n        history.push(\"/previous-purchases\");\n      }).catch(err => {\n        console.log(err);\n      });\n    });\n  };\n\n  if (!cart || !myCart) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 12\n    }, this);\n  } else {\n    const priceArray = []; //pushes each item id in the cart with its' corresponding quantity to the quantityArray,\n    //which will be updated in the cart and used in post to update item stock\n\n    myCart.map(item => {\n      quantityArray.push({\n        _id: item._id,\n        quantity: 1\n      });\n    });\n    return /*#__PURE__*/_jsxDEV(Wrapper, {\n      children: [/*#__PURE__*/_jsxDEV(LeftDiv, {\n        children: [/*#__PURE__*/_jsxDEV(HeaderDiv, {\n          children: [/*#__PURE__*/_jsxDEV(ShoppingCart, {\n            children: \"Shopping Cart\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CartQuantity, {\n            children: [myCart.length, \" Item(s)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CategoryDiv, {\n          children: [/*#__PURE__*/_jsxDEV(Description, {\n            children: \"Description\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Quantity, {\n            children: \"Quantity\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Price, {\n            children: \"Price\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), myCart.map(item => {\n          //maps over all Items, finding the _id of the specific cart item, changes stock to \n          //the quantity that are actually in stock of that item.\n          let stock = 0;\n          Items.map(item2 => {\n            if (item2._id === item._id) {\n              stock = item2.numInStock;\n            }\n          }); //removes $ from each of the prices, turns them into a Number, and pushes to an array.\n\n          const itemPriceNoSymbol = item.price.replace(/\\$/g, \"\");\n          const itemPrice = parseInt(itemPriceNoSymbol);\n          priceArray.push(itemPrice); //checks that we're getting the correct total, then adds all of prices together, creating a subtotal\n\n          if (priceArray.length === myCart.length) {\n            const reducer = (accumulator, curr) => accumulator + curr;\n\n            subtotal = priceArray.reduce(reducer).toFixed(2); //adds tax\n\n            total = (subtotal * 1.15).toFixed(2);\n          } //onChange of quantity of item in the cart, updates the quantity in the quantityArray,\n          //this will be used in the patch to determine how much of each item will be removed from stock.\n\n\n          const quantityHandler = e => {\n            quantityArray.map(object => {\n              if (object._id === item._id) {\n                object.quantity = parseInt(e.target.value);\n              }\n            });\n          };\n\n          return /*#__PURE__*/_jsxDEV(ItemDiv, {\n            children: [/*#__PURE__*/_jsxDEV(DescriptionDiv, {\n              children: [/*#__PURE__*/_jsxDEV(Img, {\n                src: item.imageSrc,\n                alt: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(SubDescripion, {\n                children: [/*#__PURE__*/_jsxDEV(ItemName, {\n                  children: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 148,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Remove, {\n                  onClick: deleteItem,\n                  id: item._id,\n                  children: \"Remove\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(QuantityDiv, {\n              children: /*#__PURE__*/_jsxDEV(Form, {\n                onChange: quantityHandler,\n                children: [/*#__PURE__*/_jsxDEV(Input, {\n                  type: \"number\",\n                  id: \"quantity\",\n                  name: \"quantity\",\n                  min: \"1\",\n                  max: stock\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Label, {\n                  for: \"quantity\",\n                  children: [\"Max \", stock === 0 ? 1 : stock]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(PriceDiv, {\n              children: /*#__PURE__*/_jsxDEV(ItemPrice, {\n                children: item.price\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 15\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(RightDiv, {\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(Div, {\n            children: \"Order Summary\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Subtotal, {\n            children: [/*#__PURE__*/_jsxDEV(Bold, {\n              children: \"Subtotal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 15\n            }, this), \" $\", subtotal]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Total, {\n            children: [/*#__PURE__*/_jsxDEV(Bold, {\n              children: \"Total\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 15\n            }, this), \" $\", total]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Div, {\n            children: \"Personal Information\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextArea, {\n            placeholder: \"Name\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextArea, {\n            placeholder: \"Surname\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextArea, {\n            placeholder: \"Email\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CheckoutButton, {\n            children: \"Checkout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this);\n  }\n};\n\n_s(Checkout, \"DbXNKVMqx6t+sTigDuVkZ+KWE4s=\", false, function () {\n  return [useHistory];\n});\n\n_c = Checkout;\nconst Label = styled.label`\nfont-family: var(--primary-font-family);\ncolor: grey;\n`;\n_c2 = Label;\nconst Input = styled.input`\nmargin-bottom: 3px;\n`;\n_c3 = Input;\nconst Bold = styled.span`\n  font-weight: bold;\n  margin-right: 15px;\n`;\n_c4 = Bold;\nconst CheckoutButton = styled.button`\n  width: 90%;\n  border-radius: 15px;\n  font-family: var(--secondary-font-family);\n  font-size: 25px;\n  border: none;\n  margin-top: 10px;\n  background-color: #ff9966;\n  color: white;\n  cursor: pointer;\n`;\n_c5 = CheckoutButton;\nconst Subtotal = styled.div`\n  font-family: var(--secondary-font-family);\n  font-size: 20px;\n`;\n_c6 = Subtotal;\nconst Total = styled.div`\n  font-family: var(--secondary-font-family);\n  font-size: 20px;\n  margin-bottom: 15px;\n`;\n_c7 = Total;\nconst Div = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 30px;\n`;\n_c8 = Div;\nconst TextArea = styled.textarea`\n  width: 90%;\n  resize: none;\n  font-family: var(--secondary-font-family);\n  font-size: 17px;\n  margin-bottom: 10px;\n`;\n_c9 = TextArea;\nconst Form = styled.form`\ndisplay: flex;\nflex-direction: column;\n`;\n_c10 = Form;\nconst SubDescripion = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n_c11 = SubDescripion;\nconst Remove = styled.button`\n  background: none;\n  border: none;\n  color: grey;\n  font-family: var(--primary-font-family);\n  font-size: 17px;\n  width: 30px;\n  padding: 0;\n  cursor: pointer;\n`;\n_c12 = Remove;\nconst CategoryDiv = styled.div`\n  width: 100%;\n  border-bottom: 1px black solid;\n  color: grey;\n  font-size: 15px;\n  display: flex;\n`;\n_c13 = CategoryDiv;\nconst Description = styled.div`\n  width: 60%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n  padding-left: 5px;\n`;\n_c14 = Description;\nconst DescriptionDiv = styled.div`\n  height: 100%;\n  width: 60%;\n  display: flex;\n  padding-right: 10px;\n  align-items: center;\n`;\n_c15 = DescriptionDiv;\nconst Quantity = styled.div`\n  width: 20%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n`;\n_c16 = Quantity;\nconst CartQuantity = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 40px;\n`;\n_c17 = CartQuantity;\nconst QuantityDiv = styled.div`\n  display: flex;\n  width: 20%;\n  align-items: center;\n  padding-left: 15px;\n`;\n_c18 = QuantityDiv;\nconst Price = styled.div`\n  width: 20%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n`;\n_c19 = Price;\nconst PriceDiv = styled.div`\n  width: 20%;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n`;\n_c20 = PriceDiv;\nconst ItemPrice = styled.div`\n  font-family: var(--secondary-font-family);\n  font-weight: bold;\n  font-size: 17px;\n`;\n_c21 = ItemPrice;\nconst ShoppingCart = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 50px;\n`;\n_c22 = ShoppingCart;\nconst HeaderDiv = styled.div`\n  width: 100%;\n  border-bottom: 1px black solid;\n  margin-top: 10px;\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-end;\n`;\n_c23 = HeaderDiv;\nconst ItemName = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 20px;\n`;\n_c24 = ItemName;\nconst Img = styled.img`\n  width: 80px;\n  padding-right: 10px;\n`;\n_c25 = Img;\nconst ItemDiv = styled.div`\n  padding: 15px;\n  border-bottom: 1px black solid;\n  display: flex;\n`;\n_c26 = ItemDiv;\nconst LeftDiv = styled.div`\n  width: 60vw;\n`;\n_c27 = LeftDiv;\nconst RightDiv = styled.div`\n  background-color: #fff3e1;\n  width: 30vw;\n  display: flex;\n  flex-direction: column;\n  padding-left: 15px;\n  padding-top: 50px;\n`;\n_c28 = RightDiv;\nconst Wrapper = styled.div`\n  width: 90vw;\n  color: black;\n  position: relative;\n  top: 8vh;\n  left: 10vw;\n  display: flex;\n`;\n_c29 = Wrapper;\nexport default Checkout;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13, _c14, _c15, _c16, _c17, _c18, _c19, _c20, _c21, _c22, _c23, _c24, _c25, _c26, _c27, _c28, _c29;\n\n$RefreshReg$(_c, \"Checkout\");\n$RefreshReg$(_c2, \"Label\");\n$RefreshReg$(_c3, \"Input\");\n$RefreshReg$(_c4, \"Bold\");\n$RefreshReg$(_c5, \"CheckoutButton\");\n$RefreshReg$(_c6, \"Subtotal\");\n$RefreshReg$(_c7, \"Total\");\n$RefreshReg$(_c8, \"Div\");\n$RefreshReg$(_c9, \"TextArea\");\n$RefreshReg$(_c10, \"Form\");\n$RefreshReg$(_c11, \"SubDescripion\");\n$RefreshReg$(_c12, \"Remove\");\n$RefreshReg$(_c13, \"CategoryDiv\");\n$RefreshReg$(_c14, \"Description\");\n$RefreshReg$(_c15, \"DescriptionDiv\");\n$RefreshReg$(_c16, \"Quantity\");\n$RefreshReg$(_c17, \"CartQuantity\");\n$RefreshReg$(_c18, \"QuantityDiv\");\n$RefreshReg$(_c19, \"Price\");\n$RefreshReg$(_c20, \"PriceDiv\");\n$RefreshReg$(_c21, \"ItemPrice\");\n$RefreshReg$(_c22, \"ShoppingCart\");\n$RefreshReg$(_c23, \"HeaderDiv\");\n$RefreshReg$(_c24, \"ItemName\");\n$RefreshReg$(_c25, \"Img\");\n$RefreshReg$(_c26, \"ItemDiv\");\n$RefreshReg$(_c27, \"LeftDiv\");\n$RefreshReg$(_c28, \"RightDiv\");\n$RefreshReg$(_c29, \"Wrapper\");","map":{"version":3,"sources":["/Users/xialiangwen/Desktop/Bootcamp/concordia-bootcamps/project-GROUP-e-commerce/client/src/components/Checkout.js"],"names":["axios","React","useState","useContext","useEffect","ItemContext","styled","useHistory","v4","uuidv4","Checkout","cart","setCart","Items","myCart","data","subtotal","total","history","quantityArray","get","then","res","catch","err","console","log","deleteItem","ev","_id","target","id","delete","document","location","reload","handleSubmit","method","url","orderId","body","map","item","push","priceArray","quantity","length","stock","item2","numInStock","itemPriceNoSymbol","price","replace","itemPrice","parseInt","reducer","accumulator","curr","reduce","toFixed","quantityHandler","e","object","value","imageSrc","name","Label","label","Input","input","Bold","span","CheckoutButton","button","Subtotal","div","Total","Div","TextArea","textarea","Form","form","SubDescripion","Remove","CategoryDiv","Description","DescriptionDiv","Quantity","CartQuantity","QuantityDiv","Price","PriceDiv","ItemPrice","ShoppingCart","HeaderDiv","ItemName","Img","img","ItemDiv","LeftDiv","RightDiv","Wrapper"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { useContext } from \"react\";\nimport { useEffect } from \"react\";\nimport { ItemContext } from \"../context/Context\";\nimport styled from \"styled-components\";\nimport { useHistory } from \"react-router-dom\";\nimport { v4 as uuidv4 } from 'uuid';\n\nconst Checkout = () => {\n  const { cart, setCart, Items} = useContext(ItemContext);\n  const myCart = cart.data;\n  let subtotal = 0;\n  let total = 0;\n  const history = useHistory();\n  let quantityArray = [];\n\n  //fetches cart from Mongo, and makes it accessible via \"cart\"\n  useEffect(() => {\n    axios\n      .get(\"/api/cart\")\n      .then((res) => {\n        setCart(res.data);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, []);\n\n  //deletes an item from the cart based on its' _id.\n  const deleteItem = (ev) => {\n    const _id = ev.target.id;\n    axios\n      .delete(`/api/cart/${_id}`)\n      .then((res) => {\n        console.log(res.data);\n        document.location.reload(true);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  //onSubmit, this function first posts everything into orderHistory, and then deletes them\n  //all from cart. Then pushes to orderHistory page.\nconst handleSubmit = (ev) => {\n  //posts the order with an id to the orderHistory \n        axios({\n        method: \"POST\",\n        url: \"/api/orderHistory\",\n        data: {\n          data: myCart,\n          orderId : uuidv4(),\n        },\n      });\n\n      //sends the quantityArray to the server. Server will iterate over each object in the a array,\n      //and modify the numInStock of each item depending on the quantity purchased.\n        axios({\n        method: 'patch',\n        url: '/api/shop/items',\n        data: {\n          body: quantityArray,\n        }\n      })\n\n      //removes each item from the cart, so that when the purchase is made, you can have a fresh cart.\n      myCart.map((item) => {\n        const _id = item._id;\n      //empties the cart after the order is made\n      axios\n        .delete(`/api/cart/${_id}`)\n        .then((res) => {\n          console.log(res.data);\n          history.push(\"/previous-purchases\");\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n\n      })\n\n    };\n\n\n  if (!cart || !myCart) {\n    return <div>Loading</div>;\n  } else {\n    const priceArray = [];\n\n    //pushes each item id in the cart with its' corresponding quantity to the quantityArray,\n    //which will be updated in the cart and used in post to update item stock\n    myCart.map((item) => {\n      quantityArray.push({ _id : item._id, quantity: 1})\n    });\n\n    return (\n      <Wrapper>\n        <LeftDiv>\n          <HeaderDiv>\n            <ShoppingCart>Shopping Cart</ShoppingCart>\n            <CartQuantity>{myCart.length} Item(s)</CartQuantity>\n          </HeaderDiv>\n          <CategoryDiv>\n            <Description>Description</Description>\n            <Quantity>Quantity</Quantity>\n            <Price>Price</Price>\n          </CategoryDiv>\n          {myCart.map((item) => {\n            //maps over all Items, finding the _id of the specific cart item, changes stock to \n            //the quantity that are actually in stock of that item.\n            let stock = 0;\n            Items.map((item2)=>{\n              if (item2._id === item._id){\n                stock = item2.numInStock;\n              } \n            })\n\n\n            //removes $ from each of the prices, turns them into a Number, and pushes to an array.\n            const itemPriceNoSymbol = item.price.replace(/\\$/g, \"\");\n            const itemPrice = parseInt(itemPriceNoSymbol);\n            priceArray.push(itemPrice);\n            //checks that we're getting the correct total, then adds all of prices together, creating a subtotal\n            if (priceArray.length === myCart.length) {\n              const reducer = (accumulator, curr) => accumulator + curr;\n              subtotal = priceArray.reduce(reducer).toFixed(2);\n              //adds tax\n              total = (subtotal * 1.15).toFixed(2);\n            }\n\n\n            //onChange of quantity of item in the cart, updates the quantity in the quantityArray,\n            //this will be used in the patch to determine how much of each item will be removed from stock.\n            const quantityHandler = (e) => {\n              quantityArray.map((object) => {\n                if (object._id === item._id) {\n                  object.quantity = parseInt(e.target.value);\n                }\n              })\n            }\n            \n            return (\n              <ItemDiv>\n                <DescriptionDiv>\n                  <Img src={item.imageSrc} alt={item.name} />\n                  <SubDescripion>\n                    <ItemName>{item.name}</ItemName>\n                    <Remove onClick={deleteItem} id={item._id}>\n                      Remove\n                    </Remove>\n                  </SubDescripion>\n                </DescriptionDiv>\n                <QuantityDiv>\n                  <Form onChange = {quantityHandler}>\n                  <Input type=\"number\" id=\"quantity\" name=\"quantity\" min=\"1\" max={stock}/>\n                  <Label for=\"quantity\">Max {stock === 0? 1:stock}</Label>\n                  </Form>\n                </QuantityDiv>\n                <PriceDiv>\n                  <ItemPrice>{item.price}</ItemPrice>\n                </PriceDiv>\n              </ItemDiv>\n            );\n          })}\n        </LeftDiv>\n        <RightDiv>\n          <Form onSubmit={handleSubmit}>\n            <Div>Order Summary</Div>\n            <Subtotal>\n              <Bold>Subtotal</Bold> ${subtotal}\n            </Subtotal>\n            <Total>\n              <Bold>Total</Bold> ${total}\n            </Total>\n            <Div>Personal Information</Div>\n            <TextArea placeholder=\"Name\" required></TextArea>\n            <TextArea placeholder=\"Surname\" required></TextArea>\n            <TextArea placeholder=\"Email\" required></TextArea>\n            <CheckoutButton>Checkout</CheckoutButton>\n          </Form>\n        </RightDiv>\n      </Wrapper>\n    );\n  }\n};\nconst Label = styled.label`\nfont-family: var(--primary-font-family);\ncolor: grey;\n`\nconst Input = styled.input`\nmargin-bottom: 3px;\n`\nconst Bold = styled.span`\n  font-weight: bold;\n  margin-right: 15px;\n`;\nconst CheckoutButton = styled.button`\n  width: 90%;\n  border-radius: 15px;\n  font-family: var(--secondary-font-family);\n  font-size: 25px;\n  border: none;\n  margin-top: 10px;\n  background-color: #ff9966;\n  color: white;\n  cursor: pointer;\n`;\nconst Subtotal = styled.div`\n  font-family: var(--secondary-font-family);\n  font-size: 20px;\n`;\nconst Total = styled.div`\n  font-family: var(--secondary-font-family);\n  font-size: 20px;\n  margin-bottom: 15px;\n`;\nconst Div = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 30px;\n`;\nconst TextArea = styled.textarea`\n  width: 90%;\n  resize: none;\n  font-family: var(--secondary-font-family);\n  font-size: 17px;\n  margin-bottom: 10px;\n`;\nconst Form = styled.form`\ndisplay: flex;\nflex-direction: column;\n`;\nconst SubDescripion = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\nconst Remove = styled.button`\n  background: none;\n  border: none;\n  color: grey;\n  font-family: var(--primary-font-family);\n  font-size: 17px;\n  width: 30px;\n  padding: 0;\n  cursor: pointer;\n`;\nconst CategoryDiv = styled.div`\n  width: 100%;\n  border-bottom: 1px black solid;\n  color: grey;\n  font-size: 15px;\n  display: flex;\n`;\nconst Description = styled.div`\n  width: 60%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n  padding-left: 5px;\n`;\nconst DescriptionDiv = styled.div`\n  height: 100%;\n  width: 60%;\n  display: flex;\n  padding-right: 10px;\n  align-items: center;\n`;\nconst Quantity = styled.div`\n  width: 20%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n`;\nconst CartQuantity = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 40px;\n`;\nconst QuantityDiv = styled.div`\n  display: flex;\n  width: 20%;\n  align-items: center;\n  padding-left: 15px;\n`;\nconst Price = styled.div`\n  width: 20%;\n  font-family: var(--primary-font-family);\n  margin-top: 3px;\n`;\nconst PriceDiv = styled.div`\n  width: 20%;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n`;\nconst ItemPrice = styled.div`\n  font-family: var(--secondary-font-family);\n  font-weight: bold;\n  font-size: 17px;\n`;\nconst ShoppingCart = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 50px;\n`;\nconst HeaderDiv = styled.div`\n  width: 100%;\n  border-bottom: 1px black solid;\n  margin-top: 10px;\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-end;\n`;\nconst ItemName = styled.div`\n  font-family: var(--primary-font-family);\n  font-size: 20px;\n`;\nconst Img = styled.img`\n  width: 80px;\n  padding-right: 10px;\n`;\nconst ItemDiv = styled.div`\n  padding: 15px;\n  border-bottom: 1px black solid;\n  display: flex;\n`;\nconst LeftDiv = styled.div`\n  width: 60vw;\n`;\nconst RightDiv = styled.div`\n  background-color: #fff3e1;\n  width: 30vw;\n  display: flex;\n  flex-direction: column;\n  padding-left: 15px;\n  padding-top: 50px;\n`;\nconst Wrapper = styled.div`\n  width: 90vw;\n  color: black;\n  position: relative;\n  top: 8vh;\n  left: 10vw;\n  display: flex;\n`;\n\nexport default Checkout;"]},"metadata":{},"sourceType":"module"}